-- A DATABASE OF THE STARS CLOSEST TO OUR SOLAR SYSTEM

-- FIRST WE CREATE THE TWO TABLES WITH OUR STARS AND THEIR INFO

CREATE TABLE STARS 
( ID INT,
  STARNAME VARCHAR(50),
  STARMASS FLOAT
)

CREATE TABLE STARSINFO
( ID INT,
  STARCOLOUR VARCHAR(50),
  STARDISTANCE FLOAT,
  STARMAGNITUDE FLOAT
  )

-- INSERTING THE DATA INTO THE STARS TABLE

INSERT INTO STARS VALUES
(1, 'PROXIMA CENTAURI', 0.1221),
(2, 'PROXIMA CENTAURI A', 1.1),
(3, 'PROXIMA CENTAURI B', 0.907),
(4, 'BARNARDS STAR', 0.144),
(5, 'WISE 1049-5319', 0.05),
(6, 'WOLF 359', 0.09),
(7, 'LALANDE 21185', 0.4),
(8, 'SIRIUS A', 2.063),
(9, 'SIRIUS B', 1.018),
(10, 'UV CETI', 0.122),
(11, 'GI 65B', 0.122),
(12, 'ROSS 154', 0.17),
(13, 'ROSS 248', 0.145),
(14, 'WISE 1506+7027', 0.0938),
(15, 'EPSILON ERIDANI', 0.82),
(16, 'LACAILLE 9352', 0.479),
(17, 'ROSS 128', 0.168),
(18, 'EZ AQUARRI', 0.1145),
(19, 'GI 866B', 0.1145),
(20, 'GI 866C', 0.1145),
(21, 'PROCYON A', 1.499),
(22, 'PROCYON B', 1.197),
(23, '61 CYGNI A', 0.7),
(24, '61 CYGNI B', 0.63),
(25, 'STRUVE 2398 A', 0.336),
(26, 'STRUVE 2398 B', 0.248),
(27, 'GROOMBRIDGE 34 A', 0.393),
(28, 'GROOMBRIDGE 34 B', 0.15),
(29, 'EPSILON INDI', 0.762),
(30, 'DX CANCRI', 0.09),
(31, 'TAU CETI', 0.783),
(32, 'GJ 1061', 0.125),
(33, 'YZ CETI', 0.13),
(34, 'LUYTENS STAR', 0.26),
(35, 'TEEGARDENS STAR', 0.08),
(36, 'KAPTEYNS STAR', 0.274),
(37, 'AX MICROSCOPIUM', 0.6),
(38, 'KRUGER 60 A', 0.271),
(39, 'KRUGER 60 B', 0.176),
(40, 'ROSS 614', 0.2228),
(41, 'GI 234 B', 0.1),
(42, 'GI 628', 0.27),
(43, 'GI 35', 0.346),
(44, 'GI 1', 0.33),
(45, 'WOLF 424', 0.14),
(46, 'GI 437 B', 0.2888)
 

 -- SELECT OUR DATA FROM THE STARS TABLE

 SELECT * FROM STARS

 -- INSERTING THE DATA INTO THE STARSINFO TABLE

 INSERT INTO STARSINFO VALUES
(1, 'RED', 4.24, 11.1),
(2, 'YELLOW', 4.36, -0.01),
(3, 'ORANGE', 4.36, 1.33),
(4, 'RED', 5.96, 9.511),
(5, 'BROWN', 6.5, 16.2),
(6, 'RED', 7.78, 13.507),
(7, 'RED', 8.3, 7.52),
(8, 'BLUE', 8.58, -1.46), 
(9, 'BLUE', 8.58, -1.33),
(10, 'RED', 8.73, 11.401),
(11, 'YELLOW', 8.73, -12.89),
(12, 'RED', 9.68, 10.44),
(13, 'RED', 10.32, 12.28),
(14, 'BROWN', 16.85, 13.56),
(15, 'ORANGE', 10.52, 3.73),
(16, 'RED', 10.74, 7.34),
(17, 'RED', 10.92, 11.13),
(18, 'RED', 11.26, 10.186),
(19, 'YELLOW', 11.26,10.39 ),
(20, 'YELLOW', 11.26, 11.89),
(21, 'WHITE', 11.4, 0.34),
(22, 'WHITE', 11.4, 10.37),
(23, 'ORANGE', 11.4, 5.21),
(24, 'ORANGE', 11.4, 6.03),
(25, 'RED', 11.52, 8.94),
(26, 'RED', 11.52, 9.70),
(27, 'RED', 11.62, 8.119),
(28, 'RED', 11.62, 11.007),
(29, 'ORANGE', 11.82, 4.69),
(30, 'RED', 11.82, 14.81),
(31, 'YELLOW', 11.88, 3.5),
(32, 'RED', 11.92, 13.03),
(33, 'RED', 12.13, 12.1),
(34, 'RED', 12.36, 9.85),
(35, 'RED', 12, 15.13),
(36, 'RED', 12.77, 8.85),
(37, 'RED', 12.86, 6.68),
(38, 'RED', 13.14, 9.59),
(39, 'RED', 13.14, 11.40),
(40, 'RED', 13.34, 11.15),
(41, 'YELLOW', 13.34, 14.23),
(42, 'YELLOW', 13.81, 10.95),
(43, 'YELLOW', 14.06, 9.85),
(44, 'YELLOW', 14.22, 8.57),
(45, 'RED', 14.30, 13.22),
(46, 'RED', 14.30, 13.21)


-- SELECT OUR DATA FROM THE STARS TABLE

 SELECT * FROM STARSINFO

-- COUNT STARS BY COLOR
 
 SELECT STARCOLOUR, COUNT(STARCOLOUR) AS COLOURNUMBER
 FROM STARSINFO
 GROUP BY STARCOLOUR

 -- AS WE CAN SEE THERE ARE 26 RED, 9 YELLOW, 5 ORANGE, 2 BROWN, 2 BLUE AND 2 WHITE STARS CLOSE TO OUR SOLAR SYSTEM

 -- ORDER STARS BY MASS

 SELECT * FROM STARS
 ORDER BY STARMASS DESC

 -- THE LARGEST STAR CLOSE TO OUR SOLAR SYSTEM IS (SIRIUS A) WITH A MASS OF (2.063) TIMES THE MASS OF OUR SUN 
 -- WHILE THE SMALLEST ONE IS (WISE 1049-5319) WITH A MASS OF (0.05) TIMES THE MASS OF OUR SUN 

 -- ORDER STARS BY DISTANCE

 SELECT STARNAME, STARCOLOUR, STARDISTANCE 
 FROM STARS JOIN STARSINFO
 ON STARS.ID = STARSINFO.ID
 ORDER BY STARDISTANCE ASC

 -- AS WE CAN SEE THE STAR CLOSEST TO OUR SOLAR SYSTEM IS (PROXIMA CANTAURI) WHICH IS A (RED) COLOURED STAR AN IS AT A DISTANCE OF 4.24 LIGHT YEARS
 -- THE STAR FARTHEST FROM OUR SOLAR SYSTEM IS (WISE 1506+7027) WHICH IS A (BROWN) COLOURED STAR AN IS AT A DISTANCE OF 16.85 LIGHT YEARS


 -- ORDER THE ORANGE STARS BY DISTANCE

 SELECT STARNAME, STARCOLOUR, STARDISTANCE 
 FROM STARS JOIN STARSINFO
 ON STARS.ID = STARSINFO.ID
 WHERE STARCOLOUR = 'ORANGE'
 ORDER BY STARDISTANCE ASC

 -- THE ORANGE STAR CLOSEST TO US IS (PROXIMA CENTAURI B) AT A DISTANCE OF 4.36 LIGHT YEARS 
 -- THE ORANGE STAR FARTHEST FROM US IS (EPSILON INDI) AT A DISTANCE OF 11.82 LIGHT YEARS

 -- INFO ABOUT A CERTAIN STAR (PROCYON A)

 SELECT STARNAME, STARMASS, STARCOLOUR, STARDISTANCE, STARMAGNITUDE 
 FROM STARS JOIN STARSINFO
 ON STARS.ID = STARSINFO.ID
 WHERE STARNAME = 'PROCYON A'

 -- WE SEE THAT (PROCYON A) IS  A (WHITE) STAR WITH A MASS OF (1.499) TIMES THE MASS OF OUR SUN,
 -- IS AT A DISTANCE OF 11.4 LIGHT YEARS AND HAS A MAGNITUDE OF 0.34

 -- STARS WITH MASS GEATER THAN OUR SUN

 SELECT STARNAME, STARMASS 
 FROM STARS
 WHERE STARMASS > 1
 ORDER BY STARMASS DESC

 -- THERE ARE 5 STARS (SIRIUS A, PROCYON A, PROCYON B, PROXIMA CENTAURI A, SIRIUS B) WITH MASS GREATER THAN OUR SUN'S

 -- FIND THE YELLOW STAR WITH THE LARGEST MAGNITUDE

 SELECT STARNAME, STARCOLOUR, STARMAGNITUDE 
 FROM STARS JOIN STARSINFO
 ON STARS.ID = STARSINFO.ID
 WHERE STARCOLOUR = 'YELLOW'
 ORDER BY STARMAGNITUDE DESC

 -- (GI 234 B) HAS A MAGNITUDE OF (14.23), THE LARGEST OF ANY YELLOW STAR

 -- WE HAVE A MISTAKE IN OUR DATA
 -- (GI 437 B) SHOULD BE (GI 473 B)
 -- LET'S FIX IT

 UPDATE STARS
 SET STARNAME = 'GI 473 B'
 WHERE STARNAME = 'GI 437 B'

 SELECT * 
 FROM STARS JOIN STARSINFO
 ON STARS.ID = STARSINFO.ID
 WHERE STARNAME = 'GI 473 B'

 -- *PLACEHOLDER FOR MORE QUERIES IN THE FUTURE*